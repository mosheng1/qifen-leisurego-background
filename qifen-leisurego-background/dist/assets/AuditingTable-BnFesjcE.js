import{H as z,_ as Z,r as i,f as o,fi as ee,a as _,c as S,fj as ae,t as f,w as e,e as t,k as n,y as r,fn as te,fg as C,g as E,fo as F,fp as le,E as T}from"./index-DQbwl3Hd.js";const se=({pageNum:d,pageSize:b,type:y})=>z.post("/api/bg/audit/list",{pageNum:d,pageSize:b,type:y}),oe=d=>z.post(`/api/bg/audit/user/${d}`),ne=d=>z.post(`/api/bg/audit/article/${d}`),ue=d=>z.post(`/api/bg/audit/comment/${d}`),L=({type:d,auditId:b,isPass:y,desc:p})=>z.post("/api/bg/audit/pass",{type:d,auditId:b,isPass:y,desc:p}),ie={class:"btn-group"},de={class:"dialog-footer"},ce={__name:"AuditingTable",setup(d,{expose:b}){const y=["内容违规","图片违规","用语不当","其他违规"],p=i(["内容违规"]),k=i(""),w=i(!1),$=i([]),c=i(0),x=i(!1),m=i({pageNum:1,pageSize:30,type:1}),h=i(!1),M=async()=>{h.value=!0;const s=await se(m.value);h.value=!1,c.value=m.value.type,$.value=s.data.data},u=i([]),I=i({}),A=async s=>{if(u.value=[],I.value=s,x.value=!0,v.value.type=m.value.type,v.value.auditId=s.auditId,console.log(s.auditId),m.value.type==1){const l=await oe(s.auditId);u.value=l.data.data}else if(m.value.type==2){const l=await ne(s.auditId);u.value=l.data.data}else if(m.value.type==3){const l=await ue(s.auditId);u.value=l.data.data}},v=i({type:0,auditId:0,isPass:-1,desc:""}),P=async s=>{s==1?p.value.includes("其他违规")&&k.value==""?T({type:"error",message:"请输入不通过原因"}):N(s):(w.value=!1,T({type:"info",message:"审核取消"}))},N=async s=>{v.value.isPass=s,v.value.desc=p.value+":"+k.value,await L(v.value),k.value="",p.value=["内容违规"],w.value=!1,x.value=!1,T({type:"success",message:"审核成功"})},U=async s=>{s==0?(v.value.isPass=s,v.value.desc="",await L(v.value),T({type:"success",message:"审核成功"}),x.value=!1):w.value=!0};return b({AuditingData:M,returnData:m}),(s,l)=>{const V=o("el-table-column"),B=o("el-tag"),D=o("el-button"),j=o("el-table"),H=o("el-pagination"),g=o("el-descriptions-item"),O=o("el-badge"),R=o("el-descriptions"),q=o("el-image"),G=o("el-tooltip"),J=o("el-drawer"),K=o("el-checkbox"),Q=o("el-checkbox-group"),W=o("el-input"),X=o("el-dialog"),Y=ee("loading");return _(),S(F,null,[ae((_(),f(j,{data:$.value.list,style:{width:"100%"},"highlight-current-row":"",onRowClick:A,size:"large","default-sort":{prop:"date",order:"descending"}},{default:e(()=>[t(V,{label:"编号"},{default:e(a=>[n(r(a.$index+1),1)]),_:1}),t(V,{label:"来源"},{default:e(a=>[t(B,{type:a.row.origin==1?"danger":"success"},{default:e(()=>[n(r(a.row.origin==1?"用户举报":"正常流程"),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"发布时间",sortable:"",prop:"createTime"}),t(V,{label:c.value!==2?"违规事项":"描述",prop:"auditDesc"},null,8,["label"]),t(V,{label:"操作"},{default:e(a=>[t(D,{size:"mini",type:"text",onClick:te(re=>A(a.row),["stop"])},{default:e(()=>[n("查看详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,h.value]]),t(H,{layout:"prev, pager, next",total:$.value.total,"hide-on-single-page":"true"},null,8,["total"]),t(J,{modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=a=>x.value=a),title:"审核详情","with-header":""},{default:e(()=>[t(R,{title:"",border:"",column:"1"},{default:e(()=>[t(g,{size:"large",label:"ID"},{default:e(()=>[n(r(I.value.auditId),1)]),_:1}),t(g,{size:"large",label:c.value==1?"名字":c.value==2?"描述":"详情"},{default:e(()=>[n(r(c.value==1?u.value.name:u.value.content),1)]),_:1},8,["label"]),c.value==1?(_(),f(g,{key:0,size:"large",label:"简介"},{default:e(()=>[n(r(u.value.desc),1)]),_:1})):C("",!0),t(g,{size:"large",label:c.value==1?"时间":"创建时间"},{default:e(()=>[n(r(I.value.createTime),1)]),_:1},8,["label"]),c.value!=2?(_(),f(g,{key:1,size:"large","label-class-name":"my-label",label:"违规项"},{title:e(()=>[t(O,{value:"new",class:"item"},{default:e(()=>[n(" 违规项 ")]),_:1})]),default:e(()=>[t(B,{type:"danger"},{default:e(()=>[n(r(I.value.auditDesc),1)]),_:1})]),_:1})):C("",!0),c.value==2?(_(),f(g,{key:2,size:"large",label:"交易额"},{default:e(()=>[n(r(u.value.price)+"/"+r(u.value.timeType===1?"月":u.value.timeType===2?"日":u.value.timeType===3?"时":"次"),1)]),_:1})):C("",!0)]),_:1}),c.value!==3?(_(),f(q,{key:0,style:{width:"100px",height:"100px"},src:u.value.image||u.value.images,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,fit:"cover","preview-src-list":u.value.image},null,8,["src","preview-src-list"])):C("",!0),E("div",ie,[t(G,{effect:"dark",content:"双击通过审核",placement:"top"},{default:e(()=>[t(D,{type:"success",onDblclick:l[0]||(l[0]=a=>U(0))},{default:e(()=>[n("通过")]),_:1})]),_:1}),t(D,{type:"danger",onClick:l[1]||(l[1]=a=>U(1))},{default:e(()=>[n("不通过")]),_:1})])]),_:1},8,["modelValue"]),t(X,{modelValue:w.value,"onUpdate:modelValue":l[7]||(l[7]=a=>w.value=a),title:"不通过原因(至少选择一种)",width:"500"},{footer:e(()=>[E("div",de,[t(D,{onClick:l[5]||(l[5]=a=>P(1))},{default:e(()=>[n("确定")]),_:1}),t(D,{type:"primary",onClick:l[6]||(l[6]=a=>P(0))},{default:e(()=>[n(" 取消 ")]),_:1})])]),default:e(()=>[t(Q,{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=a=>p.value=a),min:1},{default:e(()=>[(_(),S(F,null,le(y,a=>t(K,{key:a,label:a,value:a},{default:e(()=>[n(r(a),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"]),p.value.includes("其他违规")?(_(),f(W,{key:0,type:"textarea",modelValue:k.value,"onUpdate:modelValue":l[4]||(l[4]=a=>k.value=a),placeholder:"请输入不通过原因"},null,8,["modelValue"])):C("",!0)]),_:1},8,["modelValue"])],64)}}},ve=Z(ce,[["__scopeId","data-v-14a15534"]]);export{ve as A};
