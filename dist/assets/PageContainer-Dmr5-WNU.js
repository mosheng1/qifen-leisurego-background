import{i as h,_ as M,r as p,f as o,a as m,c as B,e as a,w as e,m as n,z as d,fn as Z,v as y,fg as $,g as C,fo as E,fp as ee,E as I,fq as q}from"./index-Dhh0PuZ4.js";const ae=({pageNum:i,pageSize:_,type:f})=>h.post("/api/bg/audit/list",{pageNum:i,pageSize:_,type:f}),te=i=>h.post(`/api/bg/audit/user/${i}`),le=i=>h.post(`/api/bg/audit/article/${i}`),se=i=>h.post(`/api/bg/audit/comment/${i}`),F=({type:i,auditId:_,isPass:f,desc:c})=>h.post("/api/bg/audit/pass",{type:i,auditId:_,isPass:f,desc:c}),oe={class:"btn-group"},ne={class:"dialog-footer"},ue={__name:"AuditingTable",setup(i,{expose:_}){const f=["内容违规","图片违规","用语不当","其他违规"],c=p(["内容违规"]),k=p(""),w=p(!1),T=p([]),r=p(0),x=p(!1),g=p({pageNum:1,pageSize:30,type:1}),L=async()=>{const s=await ae(g.value);r.value=g.value.type,T.value=s.data.data},u=p([]),z=p({}),A=async s=>{if(u.value=[],z.value=s,x.value=!0,v.value.type=g.value.type,v.value.auditId=s.auditId,console.log(s.auditId),g.value.type==1){const l=await te(s.auditId);u.value=l.data.data}else if(g.value.type==2){const l=await le(s.auditId);u.value=l.data.data}else if(g.value.type==3){const l=await se(s.auditId);u.value=l.data.data}},v=p({type:0,auditId:0,isPass:-1,desc:""}),P=async s=>{s==1?c.value.includes("其他违规")&&k.value==""?I({type:"error",message:"请输入不通过原因"}):S(s):(w.value=!1,I({type:"info",message:"审核取消"}))},S=async s=>{v.value.isPass=s,v.value.desc=c.value+":"+k.value,await F(v.value),k.value="",c.value=["内容违规"],w.value=!1,x.value=!1,I({type:"success",message:"审核成功"})},N=async s=>{s==0?(v.value.isPass=s,v.value.desc="",await F(v.value),I({type:"success",message:"审核成功"}),x.value=!1):w.value=!0};return _({AuditingData:L,returnData:g}),(s,l)=>{const V=o("el-table-column"),U=o("el-tag"),D=o("el-button"),O=o("el-table"),R=o("el-pagination"),b=o("el-descriptions-item"),j=o("el-badge"),G=o("el-descriptions"),H=o("el-image"),J=o("el-tooltip"),K=o("el-drawer"),Q=o("el-checkbox"),W=o("el-checkbox-group"),X=o("el-input"),Y=o("el-dialog");return m(),B(E,null,[a(O,{data:T.value.list,style:{width:"100%"},"highlight-current-row":"",onRowClick:A,size:"large","default-sort":{prop:"date",order:"descending"}},{default:e(()=>[a(V,{label:"编号"},{default:e(t=>[n(d(t.$index+1),1)]),_:1}),a(V,{label:"来源"},{default:e(t=>[a(U,{type:t.row.origin==1?"danger":"success"},{default:e(()=>[n(d(t.row.origin==1?"用户举报":"正常流程"),1)]),_:2},1032,["type"])]),_:1}),a(V,{label:"发布时间",sortable:"",prop:"createTime"}),a(V,{label:r.value!==2?"违规事项":"描述",prop:"auditDesc"},null,8,["label"]),a(V,{label:"操作"},{default:e(t=>[a(D,{size:"mini",type:"text",onClick:Z(re=>A(t.row),["stop"])},{default:e(()=>[n("查看详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(R,{layout:"prev, pager, next",total:T.value.total,"hide-on-single-page":"true"},null,8,["total"]),a(K,{modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=t=>x.value=t),title:"审核详情","with-header":""},{default:e(()=>[a(G,{title:"",border:"",column:"1"},{default:e(()=>[a(b,{size:"large",label:"ID"},{default:e(()=>[n(d(z.value.auditId),1)]),_:1}),a(b,{size:"large",label:r.value==1?"名字":r.value==2?"描述":"详情"},{default:e(()=>[n(d(r.value==1?u.value.name:u.value.content),1)]),_:1},8,["label"]),r.value==1?(m(),y(b,{key:0,size:"large",label:"简介"},{default:e(()=>[n(d(u.value.desc),1)]),_:1})):$("",!0),a(b,{size:"large",label:r.value==1?"时间":"创建时间"},{default:e(()=>[n(d(z.value.createTime),1)]),_:1},8,["label"]),r.value!=2?(m(),y(b,{key:1,size:"large","label-class-name":"my-label",label:"违规项"},{title:e(()=>[a(j,{value:"new",class:"item"},{default:e(()=>[n(" 违规项 ")]),_:1})]),default:e(()=>[a(U,{type:"danger"},{default:e(()=>[n(d(z.value.auditDesc),1)]),_:1})]),_:1})):$("",!0),r.value==2?(m(),y(b,{key:2,size:"large",label:"交易额"},{default:e(()=>[n(d(u.value.price)+"/"+d(u.value.timeType===1?"月":u.value.timeType===2?"日":u.value.timeType===3?"时":"次"),1)]),_:1})):$("",!0)]),_:1}),r.value!==3?(m(),y(H,{key:0,style:{width:"100px",height:"100px"},src:u.value.image||u.value.images,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,fit:"cover","preview-src-list":u.value.image},null,8,["src","preview-src-list"])):$("",!0),C("div",oe,[a(J,{effect:"dark",content:"双击通过审核",placement:"top"},{default:e(()=>[a(D,{type:"success",onDblclick:l[0]||(l[0]=t=>N(0))},{default:e(()=>[n("通过")]),_:1})]),_:1}),a(D,{type:"danger",onClick:l[1]||(l[1]=t=>N(1))},{default:e(()=>[n("不通过")]),_:1})])]),_:1},8,["modelValue"]),a(Y,{modelValue:w.value,"onUpdate:modelValue":l[7]||(l[7]=t=>w.value=t),title:"不通过原因(至少选择一种)",width:"500"},{footer:e(()=>[C("div",ne,[a(D,{onClick:l[5]||(l[5]=t=>P(1))},{default:e(()=>[n("确定")]),_:1}),a(D,{type:"primary",onClick:l[6]||(l[6]=t=>P(0))},{default:e(()=>[n(" 取消 ")]),_:1})])]),default:e(()=>[a(W,{modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=t=>c.value=t),min:1},{default:e(()=>[(m(),B(E,null,ee(f,t=>a(Q,{key:t,label:t,value:t},{default:e(()=>[n(d(t),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"]),c.value.includes("其他违规")?(m(),y(X,{key:0,type:"textarea",modelValue:k.value,"onUpdate:modelValue":l[4]||(l[4]=t=>k.value=t),placeholder:"请输入不通过原因"},null,8,["modelValue"])):$("",!0)]),_:1},8,["modelValue"])],64)}}},_e=M(ue,[["__scopeId","data-v-3d2f9e16"]]),ie={class:"header"},de={class:"extra"},ce={__name:"PageContainer",props:{title:{required:!0,type:String}},setup(i){return(_,f)=>{const c=o("el-card");return m(),y(c,{class:"page-container"},{header:e(()=>[C("div",ie,[C("span",null,d(i.title),1),C("div",de,[q(_.$slots,"extra",{},void 0,!0)])])]),default:e(()=>[q(_.$slots,"default",{},void 0,!0)]),_:3})}}},ve=M(ce,[["__scopeId","data-v-77367c31"]]);export{_e as A,ve as p};
